<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>CoreOS: Cluster out of the box</title>

		<meta name="description" content="Introduction to CoreOS, etcd, fleet and shipping containers like a boss">
		<meta name="author" content="Łukasz Adamczyk & Vladimir Mitiouchev">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/league.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<div class="slides">
				<section>
					<h2>CoreOS: Cluster out of the box</h2>
					<br>
					<h4>Introduction to CoreOS, etcd, fleet and shipping containers like a boss</h4>
					<br><br>
					<small>Created by <a href="http://adamczyk.czest.pl">Łukasz Adamczyk</a> &amp; <a href="mailto:vovcia@gmail.com">Vladimir Mitiouchev</a></small>
					<br>
					<img src="gfx/avsystem.png" style="border: 0px; background: none; box-shadow: none;">
				</section>

				<section>
					<h3>Agenda</h3>
					<br>
					<ul>
						<li class="fragment">Clustering</li>
						<li class="fragment">etcd</li>
						<li class="fragment">CoreOS</li>
						<li class="fragment">fleet</li>
					</ul>
				</section>
				<section>
					<h2>Scalability</h2>
					<br>
					<h3>How to deal with high load?</h3>
					<br>
				</section>
				<section>
					<h2>Scalability</h2>
                                        <br>
                                        <h3>Scale up - give me more!</h3>
					<img src="gfx/scale_up.svg" style="border: 0px; background: none; box-shadow: none;">
                                        <br>
					<ul>
						<li class="fragment">Give more CPU to the node..</li>
						<li class="fragment">Give more memory to the node..</li>
						<li class="fragment">Give more storage to the node..</li>
					</ul>
				</section>
                                <section>
                                        <h2>Scalability</h2>
                                        <br>
                                        <h3>Scale up - painful consequences</h3>
                                        <img src="gfx/scale_up.svg" style="border: 0px; background: none; box-shadow: none;">
                                        <br>
                                        <ul>
                                                <li class="fragment">Need for more and more expensive hardware</li>
                                                <li class="fragment">Need for careful resource planning</li>
						<li class="fragment">Availability issues - backup machine needs to be as fast as production</li>
                                        </ul>
                                </section>
                                <section>
                                        <h2>Scalability</h2>
                                        <br>
                                        <h3>Scale out - let's cluster!</h3>
                                        <img src="gfx/scale_out.svg" style="border: 0px; background: none; box-shadow: none;">
                                        <br>
                                        <ul>
                                                <li class="fragment">Use cheap hardware!</li>
						<li class="fragment">Easily add new nodes!</li>
						<li class="fragment">Remove/reuse nodes as they are not needed</li>
                                        </ul>
                                </section>
				<section>
					<h2>Clustering</h2>
					<br>
					<h3>What is cluster?</h3>
					<br>
					<ul>
						<li class="fragment">Set of connected computers that work together</li>
						<li class="fragment">...to improve performance</li>
						<li class="fragment">...and availability</li>
						<li class="fragment">...and save money!</li>
					</ul>
				</section>
				<section>
					<h2>Clustering</h2>
					<br>
					<h3>Examples:</h3>
					<br>
					<ul>
						<li class="fragment"><a href="http://www.linuxvirtualserver.org/">Linux Virtual Server</a></li>
						<li class="fragment"><a href="http://www.linux-ha.org">Linux-HA</a></li>
						<li class="fragment"><a href="http://hadoop.apache.org/">Apache Hadoop</a></li>
					</ul>
				</section>
				<section>
					<h2>Raft</h2>
					<br>
					<h3>Raft consensus algorithm</h3>
                                        <ul>
                                                <li class="fragment">Designed as an alternative to overly complicated Paxos</li>
                                                <li class="fragment">Strong leadership - flow only from leader to other servers</li>
                                                <li class="fragment">Leader election by voting with randomized timers</li>
                                                <li class="fragment">Membership changes by using join consensus approach</li>
                                        </ul>
				</section>
                                <section>
                                        <h3>Raft</h3>
					<br>
					<h3>Roles</h3>
                                        <ul>
                                                <li class="fragment">Leader</li>
                                                <li class="fragment">Follower</li>
                                                <li class="fragment">Candidate</li>
                                        </ul>
				</section>
				<section>
					<h2>Raftscope</h2>
					<br>
					<h4><a href="http://ramcloud.stanford.edu/raft.pdf">In Search of an Understandable Consensus Algorithm (Extended Version)</a></h4>
					<iframe src="raftscope/index.html" style="border: 0; width: 800px; height: 580px; margin-bottom: 20px"></iframe>
				</section>
				<section>
					<h2>Etcd</h2>
					<br>
					<img src="gfx/etcd-horizontal-color.svg" style="border: 0px; background: none; box-shadow: none;">
					<ul>
						<li class="fragment">Raft consensus algorithm</li> 
						<li class="fragment">Key-value distributed data store</li>
						<li class="fragment">Simple API - JSON on HTTP</li>
						<li class="fragment">Simple implementation of Raft consensus algorithm</li>
					</ul>
				</section>
                                <section>
                                        <h2>Etcd</h2>
                                        <br>					
                                        <img src="gfx/etcd-horizontal-color.svg" style="border: 0px; background: none; box-shadow: none;">
                                        <ul>
                                                <li class="fragment">Multiple discovery methods</li>
						<li class="fragment">Typical cluster size - 5, 7 or 9 nodes</li>
                                                <li class="fragment">Extra nodes become proxy and can be promoted to follower</li>
                                        </ul>
                                </section>
                                <section>
                                        <h2>Etcd</h2>
                                        <br>                                    
					<h3>Discovery service<h3><br>
					<pre><code data-trim contenteditable>
$ curl -w "\n" https://discovery.etcd.io/new
https://discovery.etcd.io/6a28e078895c5ec737174db2419bb2f3
</code></pre>
                                        <ul>
                                                <li class="fragment">First node become leader</li>
                                                <li class="fragment">All following nodes become peers</li>
                                                <li class="fragment">Discovery service stores peer adress and initial cluster size</li>
                                        </ul>
                                </section>
				<section>
					<h3>CoreOS</h3>
					<br>
					<ul>
						<li class="fragment">Cluster oriented</li>
						<li class="fragment">Container oriented</li>
						<li class="fragment">Chromium OS/Gentoo based</li>
					</ul>
				</section>
				
				<section>					
					<img src="gfx/coreos-containers.svg" style="border: 0px; background: none; box-shadow: none;">
				</section>

				<section>
					<h3>System updates</h3>
					<img src="gfx/coreos-update1.svg" style="border: 0px; background: none; box-shadow: none;">
					<br>
					CoreOS is currently booted off partition A. An update is installed onto partition B
				</section>

				<section>
					<h3>System updates</h3>
					<img src="gfx/coreos-update2.svg" style="border: 0px; background: none; box-shadow: none;">
					<br>
					Machine is rebooted onto the B partition
				</section>

				<section>
					<h3>System updates</h3>
					<br>
					<ul>
						<li class="fragment">Safe and easy rollback</li>
						<li class="fragment">Signed and easy to verify system image</li>
						<li class="fragment">Fast reboot with kexec</li>
					</ul>
				</section>
				
				<section>
					<h3>cloud-config</h3>
					<br>
					<ul>
						<li class="fragment">
							coreos
							<ul>
								<li class="fragment">coreos.etcd.*</li>
								<li class="fragment">coreos.fleet.*</li>
								<li class="fragment">coreos.update.*</li>
							</ul>
						</li>
						<li class="fragment">ssh_authorized_keys</li>
						<li class="fragment">hostname</li>
						<li class="fragment">users</li>
						<li class="fragment">write_files</li>
						<li class="fragment">manage_etc_hosts</li>
					</ul>
				</section>

				<section>
					<h3>cloud-config example</h3>
					<br>
					<pre><code data-trim contenteditable>
#cloud-config
hostname: foobar1
ssh_authorized_keys:
  - ssh-rsa AAAAC7KsWb3w4s9i5/HJqyAbqqyqnR9I9two2htKOsCRd...
coreos:
  update:
    reboot-strategy: best-effort
  etcd:
    # generate using https://discovery.etcd.io/new
    discovery: https://discovery.etcd.io/&lt;token&gt;
    addr: 10.20.30.1:4001
    peer_addr: 10.20.30.1:7001
  units:
    - name: etcd.service
      command: start
    - name: fleet.service
      command: start
					</code></pre>
				</section>

				<section>
					<h1>Any questions?</h1>
				</section>
				
				<section>
					<h1>Thank you for your attention</h1>
				</section>
				
				<section>
					<img src="gfx/avsystem-big.png" style="border: 0px; background: none; box-shadow: none;">
				</section>
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: false,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
